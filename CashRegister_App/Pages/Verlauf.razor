@page "/verlauf"
@using CashRegister.DAL
@using CashRegister.Models
@using CashRegister_App.Data

@inject VerlaufService VerlaufService

<table>
    <tr valign="top">
        <td>
            <MudDataGrid Style="width: 1100px;" Items="@einkaeufe" QuickFilter="@_quickFilter">
                <ToolBarContent>
                    <MudText Typo="Typo.h6">Belege</MudText>
                    <MudSpacer />
                    <MudTextField @bind-Value="_searchString" Placeholder="Search" Adornment="Adornment.Start" Immediate="true"
                        AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                </ToolBarContent>

                <Columns>
                    <Column T="Einkauf" Field="@nameof(Einkauf.Belegnummer)" />
                    <Column T="Einkauf" Field="@nameof(Einkauf.Kaufdatum)"/>
                    <Column T="Einkauf" Field="@nameof(Einkauf.Gesamtpreis)" Title="Gesamtpreis " />
                </Columns>
            </MudDataGrid>
        </td>
        <td>
            <MudPaper Height="800px" Width="500px" Square="true" Class="rounded" Style="position:fixed; background-color: #333333; margin-bottom: 20px; margin-left: 17px;" >
                @for (int i = 0; i < produktAnzahl; i++)
                {
                    int localindex = i;
                    <span class="labelclass"><pre>@i.  Thüringer Klöse  x[Anzahl]    [Preis * Anzahl]€ </pre></span>
                    
                    
                }
                <MudDivider Style="margin-top: 20px;"/>

                <span class="gesamtPreisClass"><pre>Gesamtpreis: [GesamtPreis]€</pre></span>
                
            </MudPaper>

        </td>
    </tr>
</table>



@code {
    static CashRegisterContextDB context = new CashRegisterContextDB();

    private string _searchString;
    int produktAnzahl = 5; // anzahl der Produkte

    List<Einkauf> einkaeufe = context.Einkauf.ToList();


    protected override async Task OnInitializedAsync()
    {
        einkaeufe = await VerlaufService.GetVerlaufDaten();
    }

    //Kann man in eine Andere Klasse tun und nicht hier ist nur temporär
    int ZwischenPreis(int Anzahl, int Preis)
    {
        int Ergebniss = Preis * Anzahl;

        return Ergebniss;
    }

    int GesamtPreis()
    {
        int Ergebniss = 0;

        return Ergebniss;
    }


    private Func<Einkauf, bool> _quickFilter => x =>
    {
       if (string.IsNullOrWhiteSpace(_searchString))
           return true;

       if ($"{x.Belegnummer} {x.Kaufdatum} {x.Gesamtpreis}".Contains(_searchString))
           return true;

       return false;
    };

}


